(function(e,t){"object"===typeof exports&&"undefined"!==typeof module?t(exports,require("san")):"function"===typeof define&&define.amd?define(["exports","san"],t):(e=e||self,t(e.Vusa={},e.san))})(this,(function(e,t){"use strict";var n=t.Data.prototype.get;t.Data.prototype.get=function(e,r){if(!e)return this.raw;var i=e;"string"===typeof e?e=t.parseExpr(e):i=e.paths.map((function(e){return e.value})).join("."),this._dep&&this._dep.depend({key:i,expr:e});var a=n.call(this,e,r);if(!e||void 0!==a||!this.owner||e.type!==t.ExprType.ACCESSOR)return a;var o=e.paths,s=o[0].value;if(this.owner._propKeys.concat(this.owner._dataKeys,this.owner._computedKeys).indexOf(s)>=0)return a;a=this.owner[s];for(var c=1,u=o.length;null!=a&&c<u;c++)a=a[o[c].value||t.evalExpr(o[c],r)];return a};var r=Object.assign;function i(e){for(var t={},n=0;n<e.length;n++)e[n]&&r(t,e[n]);return t}function a(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}function o(e){return null!==e&&"object"===typeof e}function s(e,t,n){Object.defineProperty(e,t,r({enumerable:!1,configurable:!0},n))}function c(e){var t=Object.create(null);return function(n){var r=t[n];return r||(t[n]=e(n))}}var u=/([^-])([A-Z])/g,l=c((function(e){return e.replace(u,"$1-$2").replace(u,"$1-$2").toLowerCase()})),f=function(e){return e.replace(/-(\w)/g,(function(e,t){return t?t.toUpperCase():""}))};function p(e){var t=!1;return function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];t||(t=!0,e.apply(this,n))}}var d="function"===typeof Object.freeze;function v(e){return d&&o(e)?Object.freeze(e):e}function h(e){return{type:t.ExprType.ACCESSOR,paths:[{type:1,value:e}]}}function m(e){return void 0===e&&(e=""),e?e.split(" ").reduce((function(e,t){var n;return t?Object.assign({},e,(n={},n[t]=1,n)):e}),{}):""}function y(e){return void 0===e&&(e={}),Object.keys(e).reduce((function(t,n){return e[n]?Object.assign({},t,m(n)):t}),{})}function b(e){void 0===e&&(e=[]);for(var t={},n=0,r=e.length;n<r;n++){var i=e[n];i&&(t=Object.assign({},t,"string"===typeof i?m(i):Array.isArray(i)?b(i):y(i)))}return t}function C(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),Object.keys(b([e,t])).join(" ")}var _=c((function(e){var t={},n=/;(?![^(]*\))/g,r=/:(.+)/;return e.split(n).forEach((function(e){if(e){var n=e.split(r);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}));function g(e){return Array.isArray(e)?i(e):"string"===typeof e?_(e):e}function w(e,t,n){return void 0===n&&(n=!0),t=g(t),n||(t.display="none"),e?r(e,t):t}var A=c((function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=n+1;return t}));function j(e){if(!isNaN(e)){var t=+e;e=A(t)}return e}function O(e,n){if("component"!==e.tagName||null==e.hotspot.props.is)return this.components[e.tagName];var r=e.props[e.hotspot.props.is],i=t.evalExpr(r.expr,n);return this.components[i]}function x(e){return e.reduce((function(e,t){var n=t.k,r=t.v;return e[n]=r,e}),{})}function $(e){var n=this;function r(e){for(var t=0,n=e.length;t<n;t++){var r=i(e[t]);if(r)return r}}function i(a){var o=a.nodeType;if(1!==o){var s;if(a.owner===n){var c,u;switch(o){case 4:case 3:if(c=a.aNode.directives.ref,u=c&&t.evalExpr(c.value,a.scope,n),c&&(u===e||f(u)===e))return 4===o?a.el:a.children.map(i);break;case 5:if(c=a.source.directives.ref,u=c&&t.evalExpr(c.value,a.scope,n),c&&(u===e||f(u)===e))return a}s=a.slotChildren&&r(a.slotChildren)}return s||r(a.children)}}return r(this.children)}var T={beforeCreate:"compiled",mounted:"attached",created:"inited",beforeMount:"created",beforeDestroy:"detached",destroy:"disposed",updated:"updated",beforeUpdate:"beforeUpdate",activated:"activated",deactivated:"deactivated"},k=Object.keys(T),E=["floor","ceil","round","abs","max","min","pow"],N={};E.forEach((function(e){N["math_"+e]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];return Math[e].apply(Math,t)}})),N.array_slice=function(e,t,n){var r=null==n?void 0:n>=0?t+n:e.length+n;return e.slice(t,r)},N.array_join=function(e,t){return e.join(t)},N.str_pos=function(e,t){return e.indexOf(t)},N.object_freeze=function(e){return Object.freeze(e)};var K={json:function(e){return JSON.stringify(json)},lower:function(e){return e.toLowerCase()},upper:function(e){return e.toUpperCase()},_cat:function(e,t){return(e||"").toString()+(t||"")}},L=Object.freeze({__proto__:null,methods:N,filters:K}),D=["filters","computed"];function S(e,t){return t?e?e.concat(t):Array.isArray(t)?t:[t]:e}function M(e){for(var t={},n=Array.isArray(e.mixins)?[L].concat(e.mixins,[e]):[L,e],i={},a=0,o=n.length;a<o;a++){var s=n[a];s.methods&&r(i,s.methods);for(var c=0;c<D.length;c++){var u=D[c];s[u]&&(t[u]=r(t[u]||{},s[u]))}for(var l=0;l<k.length;l++){var f=k[l],p=T[f];s[f]&&(t[p]=S(t[p]||[],s[f]))}}for(var d=0;d<k.length;d++){var v=k[d],h=T[v];if(t[h]){var m=t[h].slice();t[h]=1===m.length?m[0]:function(){var e=this;m.forEach((function(t){return t.call(e)}),this)}}}return t._methodKeys=Object.keys(i),r(t,i),e.messages&&(t.messages=e.messages),t}function P(){}function U(){P.target=[]}function z(){P.target=null}function R(e){"object"===typeof e&&(e=e.paths.map((function(e){return e.value})).join("."));var t=this.computedDeps[e];t||(t=this.computedDeps[e]={}),U();var n=this.computed[e].call(this),r=P.target;z();for(var i=this,a=0;a<r.length;a++){var o=r[a],s=o.expr,c=o.key;t[c]||(t[c]=1,this.watch(s,(function(){R.call(i,e)})))}this.data.set(e,n)}function q(){for(var e=this,t=this._dataKeys.concat(this._propKeys),n=t.length,r=this,i=function(e){var n=t[e];s(r,n,{get:function(){return r.data.get(h(n))},set:function(e){r.data.set(h(n),e)}})},a=0;a<n;a++)i(a);var o=this.data.owner=this;this.data._dep=new P;for(var c=function(t){var n=e._computedKeys[t];s(e,n,{get:function(){return o.data.get(h(n))}}),R.call(e,n)},u=0;u<e._computedKeys.length;u++)c(u)}function F(){var e=this,t=e.slotChildren,n=e.lifeCycle,i=e.sourceSlots;if(n.attached)return t.reduce((function(e,t){var n=t.name||"default";return e[n]||(e[n]=[]),e[n]=e[n].concat(t.children),e}),{});var a={};return i.named&&r(a,i.named),i.noname&&(a.default=i.noname),a}function W(e){return function n(r){var i=this;i.nodeType===t.NodeType.CMPT&&i._toPhase(e),i.children&&i.children.length>1&&i.children.forEach(n)}}P.prototype.depend=function(e){P.target&&P.target.push(e)},P.target=null;var J=W("activited"),V=W("deactivited"),Z=/\s+/;function B(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(Z).forEach((function(t){return e.classList.add(t)})):e.classList.add(t);else{var n=" "+(e.getAttribute("class")||"")+" ";n.indexOf(" "+t+" ")<0&&e.setAttribute("class",(n+t).trim())}}function G(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(Z).forEach((function(t){return e.classList.remove(t)})):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{var n=" "+(e.getAttribute("class")||"")+" ",r=" "+t+" ";while(n.indexOf(r)>=0)n=n.replace(r," ");n=n.trim(),n?e.setAttribute("class",n):e.removeAttribute("class")}}var H=c((function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}}));function I(e){if(e){if("object"===typeof e){var t={};return!1!==e.css&&r(t,H(e.name||"v")),r(t,e),t}return"string"===typeof e?H(e):void 0}}var Q="transition",X="animation",Y="transition",ee="transitionend",te="animation",ne="animationend";void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Y="WebkitTransition",ee="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(te="WebkitAnimation",ne="webkitAnimationEnd");var re=window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout;function ie(e){re((function(){re(e)}))}var ae=/\b(transform|all)(,|$)/;function oe(e,t){var n,r=window.getComputedStyle(e),i=(r[Y+"Delay"]||"").split(", "),a=(r[Y+"Duration"]||"").split(", "),o=se(i,a),s=(r[te+"Delay"]||"").split(", "),c=(r[te+"Duration"]||"").split(", "),u=se(s,c),l=0,f=0;t===Q?o>0&&(n=Q,l=o,f=a.length):t===X?u>0&&(n=X,l=u,f=c.length):(l=Math.max(o,u),n=l>0?o>u?Q:X:null,f=n?n===Q?a.length:c.length:0);var p=n===Q&&ae.test(r[Y+"Property"]);return{type:n,timeout:l,propCount:f,hasTransform:p}}function se(e,t){while(e.length<t.length)e=e.concat(e);return Math.max.apply(null,t.map((function(t,n){return ce(t)+ce(e[n])})))}function ce(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function ue(e,t){var n=e._transitionClasses||(e._transitionClasses=[]);n.indexOf(t)<0&&(n.push(t),B(e,t))}function le(e,t){e._transitionClasses&&a(e._transitionClasses,t),G(e,t)}function fe(e){return"number"===typeof e&&!isNaN(e)}function pe(e,t,n){var r=oe(e,t),i=r.type,a=r.timeout,o=r.propCount;if(!i)return n();var s=i===Q?ee:ne,c=0,u=function(t){t.target===e&&++c>=o&&l()},l=function(){e.removeEventListener(s,u),n()};setTimeout((function(){c<o&&l()}),a+1),e.addEventListener(s,u)}function de(e){var t=I(e),n=t.css,r=t.type,i=t.enterClass,a=t.enterToClass,s=t.enterActiveClass,c=t.appearClass,u=t.appearToClass,l=t.appearActiveClass,f=t.beforeEnter,d=t.enter,v=t.afterEnter,h=t.enterCancelled,m=t.beforeAppear,y=t.appear,b=t.afterAppear,C=t.appearCancelled,_=t.leaveClass,g=t.leaveToClass,w=t.leaveActiveClass,A=t.beforeLeave,j=t.leave,O=t.afterLeave,x=t.leaveCancelled,$=t.delayLeave,T=t.duration,k=this,E=!1!==n;return{enter:K,leave:L};function N(e){if(!e)return!1;if("function"===typeof e)return e;var t=k.owner[e];return!(!t||"function"!==typeof t)&&t}function K(e,t){var n=!k.lifeCycle.attached;if(e._leaveCb&&(e._leaveCb.cancelled=!0,e._leaveCb()),!e._enterCb&&1===e.nodeType&&(!n||y)){var _=n&&c?c:i,g=n&&l?l:s,w=n&&u?u:a,A=n&&N(m)||N(f),j=n&&N(y)||N(d),O=n&&N(b)||N(v),x=n&&N(C)||N(h),$=+(o(T)?T.enter:T),K=j&&j.length>1,L=e._enterCb=p((function(){E&&(le(e,w),le(e,g)),L.cancelled?(E&&le(e,_),x&&x(e)):O&&O(e),e._enterCb=null}));j&&j(e,L),A&&A(e),E&&(ue(e,_),ue(e,g),ie((function(){le(e,_),L.cancelled||(ue(e,w),K||(fe($)?setTimeout(L,$):pe(e,r,L)))}))),E||K||L(),t()}}function L(e,t){if(e._enterCb&&(e._enterCb.cancelled=!0,e._enterCb()),!e._leaveCb){var n=N(j),i=N($),a=N(A),s=N(O),c=+(o(T)?T.leave:T),u=n&&n.length>1,l=e._leaveCb=p((function(){E&&(le(e,g),le(e,w)),l.cancelled?(E&&le(e,_),x&&x(e)):(t(),s&&s(e)),e._leaveCb=null}));i?i(f):f()}function f(){l.cancelled||(a&&a(e),E&&(ue(e,_),ue(e,w),ie((function(){le(e,_),l.cancelled||(ue(e,g),u||(fe(c)?setTimeout(l,c):pe(e,r,l)))}))),n&&n(e,l),E||u||l())}}}var ve=function(){},he={$activate:J,$deactivate:V,_mc:C,_ms:w,_l:j,_ex:r,_ocp:x,_noop:ve,_t:de,getComponentType:O,$emit:t.Component.prototype.fire,$on:t.Component.prototype.on,$watch:t.Component.prototype.watch,$nextTick:t.nextTick},me={$el:function(){return this.el},$context:function(){return this.owner},$parent:function(){return this.parentComponent},$children:function(){return this.children.filter((function(e){return 5===e.nodeType}))},$root:function(){var e=this;if(this.parentComponent)while(e.parentComponent)e=e.parentComponent;return e},$slots:F,_isDestroyed:function(){return!!this.lifeCycle.disposed}},ye=t.Component.prototype._update;t.Component.prototype._update=function(e){e&&this._toPhase("beforeUpdate"),ye.call(this,e)};var be="_SanCtor";function Ce(e){if(e[be])return e[be];var n={};if(e.components&&(n.components=Object.keys(e.components).reduce((function(n,r){var i=e.components[r];return n[r]=n[l(r)]=i instanceof t.Component?i:i.template||i.aNode?t.defineComponent(i):Ce(i),n}),{}),n._cmptReady=1),e.template||e.aNode||e instanceof t.Component)return t.defineComponent(r({},e,n));var i=r(n,{template:e.__santemplate,aNode:e.__sanaNode,_isSan:!0},he,M(e)),a=i.compiled;i.compiled=function(){this._calcComputed=ve,a&&a.call(this);var t=Object.keys(me).reduce((function(e,t){return e[t]={get:function(){return me[t].call(this)}},e}),{});t.$options={value:e},Object.defineProperties(this,t)};var o=e.__sanRefs,c=i.inited;i.inited=function(){var t=this,n=this;if(this.$refs=Object.create(null),o){for(var r=function(e,t){var r=o[e];s(n.$refs,r.name,{get:function(){return r.root?n.el:n.ref(r.name)}})},i=0,a=o.length;i<a;i++)r(i,a);n.ref=$}this.$style&&this.data.set(h("$style"),v(this.$style)),q.call(this);for(var u=0;u<this._methodKeys.length;u++){var l=this._methodKeys[u];this[l]=this[l].bind(this)}c&&c.call(this),e.watch&&Object.keys(e.watch).forEach((function(n){t.watch(n,e.watch[n].bind(t))})),e.preprocessANode&&e.preprocessANode.call(this)};var u=i.beforeUpdate;i.beforeUpdate=function(){u&&u.call(this),e.preprocessANode&&e.preprocessANode.call(this)},i.initData=function(){var t=this,n={};if(e.props){var i=t._propKeys=e._propKeys=e.props?Array.isArray(e.props)?e.props:Object.keys(e.props):[];if(!Array.isArray(e.props))for(var a=0,o=i.length;a<o;a++){var s=i[a],c=e.props[s];"default"in c&&(n[s]="function"===typeof c.default?c.default():c.default)}}else t._propKeys=[];e.computed?t._computedKeys=Object.keys(e.computed):t._computedKeys=[];var u="function"===typeof e.data?e.data.call(r({},n,this._srcSbindData)):e.data||{};return this._dataKeys=Object.keys(u)||[],r({$style:{}},n,u)};var f=t.defineComponent(i);return e[be]=f}e.defineComponent=Ce,Object.defineProperty(e,"__esModule",{value:!0})}));
