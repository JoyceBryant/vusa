(function(e,t){"object"===typeof exports&&"undefined"!==typeof module?t(exports,require("san")):"function"===typeof define&&define.amd?define(["exports","san"],t):(e="undefined"!==typeof globalThis?globalThis:e||self,t(e.Vusa={},e.san))})(this,(function(e,t){"use strict";function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t["default"]=e,Object.freeze(t)}var r=n(t),o=t.Data.prototype.get;t.Data.prototype.get=function(e,n){if(!e)return this.raw;var r=e;"string"===typeof e?e=t.parseExpr(e):r=e.paths.map((function(e){return e.value})).join("."),this._dep&&this._dep.depend({key:r,expr:e});var a=o.call(this,e,n);if(!e||void 0!==a||!this.owner||e.type!==t.ExprType.ACCESSOR)return a;var i=e.paths,s=i[0].value;if(this.owner._propKeys.concat(this.owner._dataKeys,this.owner._computedKeys).indexOf(s)>=0)return a;for(var c=1,u=i.length;null!=a&&c<u;c++)a=a[i[c].value||t.evalExpr(i[c],n)];return a};var a=Object.assign;function i(e){for(var t={},n=0;n<e.length;n++)e[n]&&a(t,e[n]);return t}function s(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}var c=Object.prototype.toString;function u(e){return null!==e&&"object"===typeof e}var f=Object.prototype.hasOwnProperty;function p(e,t){return f.call(e,t)}function l(e){return"[object Object]"===c.call(e)}function d(e){return null==e?"":Array.isArray(e)||l(e)&&e.toString===c?JSON.stringify(e,null,2):String(e)}function v(e,t,n){Object.defineProperty(e,t,a({enumerable:!1,configurable:!0},n))}function h(e){var t=Object.create(null);return function(n){var r=t[n];return r||(t[n]=e(n))}}var y=/([^-])([A-Z])/g,m=h((function(e){return e.replace(y,"$1-$2").replace(y,"$1-$2").toLowerCase()})),_=function(e){return e.replace(/-(\w)/g,(function(e,t){return t?t.toUpperCase():""}))};function b(e){var t=!1;return function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];t||(t=!0,e.apply(this,n))}}var g="function"===typeof Object.freeze;function C(e){return g&&u(e)?Object.freeze(e):e}function x(e){return{type:t.ExprType.ACCESSOR,paths:[{type:1,value:e}]}}function O(e){return"string"===typeof e||"number"===typeof e||"symbol"===typeof e||"boolean"===typeof e}function w(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}var A=h((function(e){var t={},n=/;(?![^(]*\))/g,r=/:(.+)/;return e.split(n).forEach((function(e){if(e){var n=e.split(r);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}));function j(){}var E=h((function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=n+1;return t}));function T(e){if(!isNaN(e)){var t=+e;e=E(t)}return"string"===typeof e?e.split(""):e}function k(e){return e.reduce((function(e,t){var n=t.k,r=t.v;return e[n]=r,e}),{})}function S(e){var t=this;function n(e){for(var t=0,n=e.length;t<n;t++){var r=o(e[t]);if(r)return r}}function o(a){var i=a.nodeType;if(1!==i){var s;if(a.owner===t){var c,u;switch(i){case 4:case 3:if(c=a.aNode.directives.ref,u=c&&r.evalExpr(c.value,a.scope,t),c&&(u===e||_(u)===e))return 4===i?a.el:a.children.map(o);break;case 5:if(c=a.source.directives.ref,u=c&&r.evalExpr(c.value,a.scope,t),c&&(u===e||_(u)===e))return a}s=a.slotChildren&&n(a.slotChildren)}return s||n(a.children)}}return n(this.children)}var N={beforeCreate:"compiled",mounted:"attached",created:"inited",beforeMount:"created",beforeDestroy:"detached",destroy:"disposed",updated:"updated",beforeUpdate:"beforeUpdate",activated:"activated",deactivated:"deactivated",errorCaptured:"error"},$=Object.keys(N);function P(e){return void 0===e&&(e=""),e?e.split(" ").reduce((function(e,t){var n;return t?Object.assign({},e,(n={},n[t]=1,n)):e}),{}):""}function R(e){return void 0===e&&(e={}),Object.keys(e).reduce((function(t,n){return e[n]?Object.assign({},t,P(n)):t}),{})}function L(e){void 0===e&&(e=[]);for(var t={},n=0,r=e.length;n<r;n++){var o=e[n];o&&(t=Object.assign({},t,"string"===typeof o?P(o):Array.isArray(o)?L(o):R(o)))}return t}function D(e,t){return void 0===e&&(e={}),void 0===t&&(t=""),Object.keys(L([t,e])).join(" ")}function K(e){var t={};for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[m(n)]=e[n]);return t}function M(e){return Array.isArray(e)?K(i(e)):"string"===typeof e?A(e):K(e)}function U(e,t,n){return e=M(e),n||(e.display="none"),Object.keys(e).forEach((function(t){var n=e[t];Array.isArray(n)&&(e[t]=n[n.length-1])})),t?a(t,e):e}var z=["floor","ceil","round","abs","max","min","pow"],F={};z.forEach((function(e){F["math_"+e]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];return Math[e].apply(Math,t)}})),F.array_slice=function(e,t,n){var r=null==n?void 0:n>=0?t+n:e.length+n;return e.slice(t,r)},F.array_join=function(e,t){return e.join(t)},F.str_pos=function(e,t){return e.indexOf(t)},F.object_freeze=function(e){return Object.freeze(e)};var q={json:function(e){return JSON.stringify(e)},lower:function(e){return e.toLowerCase()},upper:function(e){return e.toUpperCase()},_s:function(e){return d(e)},_cat:function(e,t){return e||0===e||(e=""),t||0===t||(t=""),e.toString()+t.toString()},_mc:D,_ms:U},B=["filters"],G={methods:F,filters:q};function I(e,t){return t?e?e.concat(t):Array.isArray(t)?t:[t]:e}function J(e){for(var t={},n=Array.isArray(e.mixins)?[G].concat(e.mixins,[e]):[G,e],r={},o=0,i=n.length;o<i;o++){var s=n[o];s.methods&&a(r,s.methods);for(var c=0;c<B.length;c++){var u=B[c];s[u]&&(t[u]=a(t[u]||{},s[u]))}for(var f=0;f<$.length;f++){var p=$[f],l=N[p];s[p]&&(t[l]=I(t[l]||[],s[p]))}}for(var d=0;d<$.length;d++){var v=$[d],h=N[v];if(t[h]){var y=t[h].slice();t[h]=1===y.length?y[0]:function(){var e=this;y.forEach((function(t){return t.call(e)}),this)}}}return t._methodKeys=Object.keys(r),a(t,r),e.messages&&(t.messages=e.messages),t}function W(){}function V(){W.target=[]}function Z(){W.target=null}function H(e,t){"object"===typeof e&&(e=e.paths.map((function(e){return e.value})).join("."));var n=this.computedDeps[e];n||(n=this.computedDeps[e]={}),V();var r=t[e];"object"===typeof r&&(r=r.get||j);var o=r.call(this),a=W.target;Z();for(var i=this,s=0;s<a.length;s++){var c=a[s],u=c.expr,f=c.key;n[f]||(n[f]=1,this.watch(u,(function(){H.call(i,e,t)})))}this.data.set(e,o)}W.prototype.depend=function(e){W.target&&W.target.push(e)},W.target=null;var Q=Array.prototype,X=Object.create(Q),Y=["push","pop","shift","unshift","splice","sort","reverse"];Y.forEach((function(e){var t=Q[e];v(X,e,{value:function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];var o=this.__ob__;switch(e){case"push":case"unshift":o.context.data[e](o.expr,n[0]);break;case"pop":case"shift":o.context.data[e](o.expr);break;case"splice":o.context.data.splice(o.expr,n);break;default:o.context.data.set(o.expr,t.apply(this.slice(),n))}var a=o.context.data.get(o.expr);return ne(a,o.expr,o.context),a}})}));var ee=function(e,t,n){this.expr=t,this.context=n,v(e,"__ob__",{value:this}),this.value=e,Array.isArray(e)?(e.__proto__=X,this.observeArray(e)):(this.keys=Object.keys(e)||[],this.walk(e))};function te(e,n,r,o){var a=Object.getOwnPropertyDescriptor(e,n);if(!a||!1!==a.configurable){var i=a&&a.get,s=a&&a.set,c={type:t.ExprType.ACCESSOR,paths:r.paths.concat([{type:t.ExprType.STRING,value:n}])},u=new W,f=e[n];ne(f,c,o);var p={enumerable:!0,configurable:!0,set:function(t){var n=i?i.call(e):f;t!==n&&(i&&!s||(s?s.call(e,t):f=t,ne(t,c,o),o.data.set(c,t,{force:!0})))},get:function(){u.depend({context:o,expr:c});var t=i?i.call(e):f;return t}};v(e,n,p)}}function ne(e,t,n){var r;if(u(e))return p(e,"__ob__")&&e.__ob__ instanceof ee?r=e.__ob__:(Array.isArray(e)||l(e))&&Object.isExtensible(e)&&(r=new ee(e,t,n)),r}function re(e,n,r){if(null!=e&&!O(e)){var o=t.parseExpr(n);if(e.nodeType===t.NodeType.CMPT)return e.data.set(o,r,{force:!0}),r;var a=e.__ob__;if(a&&Array.isArray(e)&&w(n))e.length=Math.max(e.length,n),a.context.data.splice(a.expr,o,1,r);else if(a){var i={type:t.ExprType.ACCESSOR,paths:a.expr.paths.concat(o.paths)};a.context.set(i,r,{force:!0})}}}function oe(e){for(var n=this,r=this._dataKeys.concat(this._propKeys),o=r.length,a=this,i=new W,s=function(e){var n=r[e],o={type:t.ExprType.ACCESSOR,paths:[{type:t.ExprType.STRING,value:n}]};v(a,n,{get:function(){i.depend({context:a,expr:o});var e=a.data.get(o);return ne(e,o,a),e},set:function(e){u(e)&&p(e,"__ob__")&&(e=Array.isArray(e)?e.slice():Object.assign({},e)),a.data.set(o,e)}})},c=0;c<o;c++)s(c);var f=this.data.owner=this;this.computedDeps={};for(var l=function(e){var r=n._computedKeys[e],o={type:t.ExprType.ACCESSOR,paths:[{type:t.ExprType.STRING,value:r}]};v(n,r,{get:function(){return i.depend({context:a,expr:o}),f.data.get(x(r))}})},d=0;d<n._computedKeys.length;d++)l(d);for(var h=0;h<this._computedKeys.length;h++){var y=this._computedKeys[h];H.call(this,y,e)}}function ae(){var e=this,t=e.slotChildren,n=e.lifeCycle,r=e.sourceSlots;if(n.attached)return t.reduce((function(e,t){var n=t.name||"default";return e[n]||(e[n]=[]),e[n]=e[n].concat(t.children),e}),{});var o={};return r.named&&a(o,r.named),r.noname&&(o.default=r.noname),o}function ie(e){return function n(r){var o=this;o.nodeType===t.NodeType.CMPT&&o._toPhase(e),o.children&&o.children.length>1&&o.children.forEach(n)}}ee.prototype.walk=function(e){for(var t=this.keys,n=0;n<t.length;n++)te(e,t[n],this.expr,this.context)},ee.prototype.observeArray=function(e){for(var n=0,r=e.length;n<r;n++)ne(e[n],a({},this.expr,{paths:this.expr.paths.concat([{type:t.ExprType.NUMBER,value:n}])}),this.context)};var se=ie("activited"),ce=ie("deactivited"),ue=/\s+/;function fe(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(ue).forEach((function(t){return e.classList.add(t)})):e.classList.add(t);else{var n=" "+(e.getAttribute("class")||"")+" ";n.indexOf(" "+t+" ")<0&&e.setAttribute("class",(n+t).trim())}}function pe(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(ue).forEach((function(t){return e.classList.remove(t)})):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{var n=" "+(e.getAttribute("class")||"")+" ",r=" "+t+" ";while(n.indexOf(r)>=0)n=n.replace(r," ");n=n.trim(),n?e.setAttribute("class",n):e.removeAttribute("class")}}var le=h((function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}}));function de(e){if(e){if("object"===typeof e){var t={};return!1!==e.css&&a(t,le(e.name||"v")),a(t,e),t}return"string"===typeof e?le(e):void 0}}var ve="undefined"!==typeof window,he="transition",ye="animation",me="transition",_e="transitionend",be="animation",ge="animationend";ve&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(me="WebkitTransition",_e="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(be="WebkitAnimation",ge="webkitAnimationEnd"));var Ce=ve?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function xe(e){Ce((function(){Ce(e)}))}var Oe=/\b(transform|all)(,|$)/;function we(e,t){var n,r=window.getComputedStyle(e),o=(r[me+"Delay"]||"").split(", "),a=(r[me+"Duration"]||"").split(", "),i=Ae(o,a),s=(r[be+"Delay"]||"").split(", "),c=(r[be+"Duration"]||"").split(", "),u=Ae(s,c),f=0,p=0;t===he?i>0&&(n=he,f=i,p=a.length):t===ye?u>0&&(n=ye,f=u,p=c.length):(f=Math.max(i,u),n=f>0?i>u?he:ye:null,p=n?n===he?a.length:c.length:0);var l=n===he&&Oe.test(r[me+"Property"]);return{type:n,timeout:f,propCount:p,hasTransform:l}}function Ae(e,t){while(e.length<t.length)e=e.concat(e);return Math.max.apply(null,t.map((function(t,n){return je(t)+je(e[n])})))}function je(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Ee(e,t){var n=e._transitionClasses||(e._transitionClasses=[]);n.indexOf(t)<0&&(n.push(t),fe(e,t))}function Te(e,t){e._transitionClasses&&s(e._transitionClasses,t),pe(e,t)}function ke(e){return"number"===typeof e&&!isNaN(e)}function Se(e,t,n){var r=we(e,t),o=r.type,a=r.timeout,i=r.propCount;if(!o)return n();var s=o===he?_e:ge,c=0,u=function(t){t.target===e&&++c>=i&&f()},f=function(){e.removeEventListener(s,u),n()};setTimeout((function(){c<i&&f()}),a+1),e.addEventListener(s,u)}function Ne(e){var t=de(e),n=t.css,r=t.type,o=t.enterClass,a=t.enterToClass,i=t.enterActiveClass,s=t.appearClass,c=t.appearToClass,f=t.appearActiveClass,p=t.onBeforeEnter,l=t.onEnter,d=t.onAfterEnter,v=t.onEnterCancelled,h=t.onBeforeAppear,y=t.onAppear,m=t.onAfterAppear,_=t.onAppearCancelled,g=t.leaveClass,C=t.leaveToClass,x=t.leaveActiveClass,O=t.onBeforeLeave,w=t.onLeave,A=t.onAfterLeave,j=t.onLeaveCancelled,E=t.onDelayLeave,T=t.duration,k=this,S=!1!==n;return{enter:$,leave:P};function N(e){if(!e)return!1;if("function"===typeof e)return e;var t=k[e];return!(!t||"function"!==typeof t)&&t}function $(e,t){var n=!k.lifeCycle.attached;if(e._leaveCb&&(e._leaveCb.cancelled=!0,e._leaveCb()),!e._enterCb&&1===e.nodeType&&(!n||y)){var g=n&&s?s:o,C=n&&f?f:i,x=n&&c?c:a,O=n&&N(h)||N(p),w=n&&N(y)||N(l),A=n&&N(m)||N(d),j=n&&N(_)||N(v),E=+(u(T)?T.enter:T),$=w&&w.length>1,P=e._enterCb=b((function(){S&&(Te(e,x),Te(e,C)),P.cancelled?(S&&Te(e,g),j&&j(e)):A&&A(e),e._enterCb=null}));w&&w(e,P),O&&O(e),S&&(Ee(e,g),Ee(e,C),xe((function(){Te(e,g),P.cancelled||(Ee(e,x),$||(ke(E)?setTimeout(P,E):Se(e,r,P)))}))),S||$||P(),t()}}function P(e,t){if(e._enterCb&&(e._enterCb.cancelled=!0,e._enterCb()),!e._leaveCb){var n=N(w),o=N(E),a=N(O),i=N(A),s=+(u(T)?T.leave:T),c=n&&n.length>1,f=e._leaveCb=b((function(){S&&(Te(e,C),Te(e,x)),f.cancelled?(S&&Te(e,g),j&&j(e)):(t(),i&&i(e)),e._leaveCb=null}));o?o(p):p()}function p(){f.cancelled||(a&&a(e),S&&(Ee(e,g),Ee(e,x),xe((function(){Te(e,g),f.cancelled||(Ee(e,C),c||(ke(s)?setTimeout(f,s):Se(e,r,f)))}))),n&&n(e,f),S||c||f())}}}function $e(e){return e.split(/(?=<)/g).map((function(e){if(/^<\//.test(e)||e.indexOf(">")<0)return e;var t=/\s*(on[^\s"'<>\/=]+)\s*=/gi,n=e.indexOf(">"),r=e.slice(n+1),o=e.slice(0,n+1).replace(t,(function(e,t){return e.replace(t,t+"-safe")}));return o+r})).join("")}function Pe(e){if(e.indexOf("<")>-1){var t=/((<script.*?<\/script>)|(<style.*?<\/style>))/gi,n={"<":"&lt;",">":"&gt;",'"':"&quot;"};return e=e.replace(t,(function(e){return e.replace(/([<>"])/g,(function(e){return n[e]}))})),$e(e)}return e}function Re(e){return"[object Object]"===Object.prototype.toString.call(e)}function Le(e){return null==e?"":Array.isArray(e)||Re(e)&&e.toString===Object.prototype.toString?JSON.stringify(e,null,2):String(e)}function De(e){return!0===e||e&&"string"===typeof e?"disabled":e}var Ke="__COMPONENT_REFERENCE__",Me=function(){},Ue=function(e){return this.filters[e]},ze={$activate:se,$deactivate:ce,_l:T,_ex:a,_ocp:k,_noop:Me,_t:Ne,_sf:Pe,_f:Ue,_h:Le,$emit:t.Component.prototype.fire,$on:t.Component.prototype.on,$watch:t.Component.prototype.watch,$nextTick:t.nextTick,$set:re,_da:De,$destroy:t.Component.prototype.dispose},Fe=t.defineComponent(ze),qe={$el:function(){return this.el},$data:function(){return this.data&&this.data.raw},$context:function(){return this.owner},$parent:function(){return this.parentComponent},$children:function(){var e=[];return this._rootNode&&this.tagName!==this._rootNode.tagName&&this._rootNode.lifeCycle&&!this._rootNode.lifeCycle.disposed&&e.unshift(this._rootNode),e.concat(this.children).filter((function(e){return 5===e.nodeType}))},$root:function(){var e=this;if(this.parentComponent)while(e.parentComponent)e=e.parentComponent;if(e&&e.data&&e.data.data&&e.data.data.$root)for(var t in e.data.data.$root)e[t]=e.data.data.$root[t];return e},$slots:ae,_isDestroyed:function(){return!!this.lifeCycle.disposed}},Be=t.Component.prototype._update;t.Component.prototype._update=function(e){e&&this._toPhase("beforeUpdate"),Be.call(this,e)};var Ge="_SanCtor",Ie=x("$style");function Je(e){if(e&&e[Ke])return e;if(e instanceof t.Component||e instanceof Fe){var n=e.prototype;if(!n.hasOwnProperty("_cmptReady")){var r=e.components||n.components||{};n.components=We(r),n._cmptReady=1}return e}return"function"===typeof e?t.createComponentLoader((function(){return new Promise((function(t){e((function(e){t(Ve(e))}))}))})):e.template||e.aNode||e.aPack?(e.components&&(e.components=We(e.components),e._cmptReady=1),t.defineComponent(e)):Ve(e)}function We(e){return e=Object.keys(e).reduce((function(t,n){var r=e[n];return t[n]=t[m(n)]=Je(r),t}),a({},G.components))}function Ve(e){if(e.hasOwnProperty(Ge))return e[Ge];if("function"===typeof e)return Je(e);var n={};if(e.components&&(n.components=We(e.components),n._cmptReady=1),e.template||e.aNode||e.aPack||e instanceof t.Component||e instanceof Fe)return t.defineComponent(a({},e,n));var r=e.__sanOptimizeSSR||!1,o=a(n,{template:e.__santemplate,aNode:e.__sanaNode,aPack:e.__sanaPack,_isSan:!0},J(e)),i=e.__sanRefs,s=o.inited;o.inited=function(){var t=this,n=this;if(!r&&(this.$refs=Object.create(null),i)){for(var o=function(e,t){var r=i[e];v(n.$refs,r.name,{get:function(){return r.root?n.el:n.ref(r.name)}})},a=0,c=i.length;a<c;a++)o(a,c);n.ref=S}if(this.$style&&this.data.set(Ie,C(this.$style)),r){if(e.computed&&r)for(var u in e.computed)if(Object.hasOwnProperty.call(e.computed,u)){var f=e.computed[u];this.data.data[u]=f.call(this.data.data)}}else oe.call(this,e.computed);s&&s.call(this),e.watch&&!r&&Object.keys(e.watch).forEach((function(n){t.watch(n,e.watch[n].bind(t))})),e.preprocessANode&&e.preprocessANode.call(this)};var c=o.beforeUpdate;o.beforeUpdate=function(){c&&c.call(this),e.preprocessANode&&e.preprocessANode.call(this)};var u=o.compiled;o.initData=function(){this._calcComputed=Me,u&&u.call(this);var t=this,n=Object.keys(qe).reduce((function(e,n){return e[n]={get:function(){return qe[n].call(t)}},e}),{});n.$options={value:e},Object.defineProperties(this,n);var o={};if(e.props){var i=e.props?Array.isArray(e.props)?e.props:Object.keys(e.props):[];r||(t._propKeys=e._propKeys=i);var s=i.length;if(s>0&&!Array.isArray(e.props))for(var c=0,f=i.length;c<f;c++){var p=i[c],l=e.props[p];l.default&&(o[p]="function"===typeof l.default?l.default():l.default)}}else t._propKeys=[];var d="function"===typeof e.data?e.data.call(a({},o,r?this.data.data:this._srcSbindData)):e.data||{};r||(this._dataKeys=Object.keys(d)||[]);var v=a({$style:{}},o,d);return!r&&e.computed?t._computedKeys=Object.keys(e.computed):r||(t._computedKeys=[]),r&&Object.defineProperties(this.data.data,n),v};var f=t.defineComponent(o,Fe);return e[Ge]=f}var Ze=function(e){J(e)},He=function(e,t){G.components=G.components||{},G.components[e]=Ve(t)};e.component=He,e.defineComponent=Ve,e.mixin=Ze,Object.defineProperty(e,"__esModule",{value:!0})}));
